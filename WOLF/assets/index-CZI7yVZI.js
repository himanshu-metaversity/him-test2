import{j as e,r as o,d as k,a as L}from"./index-CLajQCFY.js";import{F as M,U as _,D as r,a5 as v}from"./App-_Muo2KxM.js";import{F as Y}from"./Filter-Ded0tcgT.js";import{A as P,P as B,a as E,d as W,b as q}from"./styledComponents-Dc9xxvUG.js";import{u as O,G as l,A as $,D as G}from"./index-BOfNt5KB.js";import{F as H}from"./Footer-lwCx5gOJ.js";import{r as T,q as U,E as V,e as N}from"./ResetPasswordDailog-DENbGFi4.js";import{A as Q}from"./activityLogTable-ChA1-vE-.js";import{B as J}from"./index-BA2x03uO.js";import{h as w}from"./moment-D15uM1gO.js";import"./Search-DXNokGWw.js";const f=[{id:"username",label:"Username",minWidth:70},{id:"date",label:"Date",minWidth:70},{id:"ip",label:"Ip Address",minWidth:70},{id:"detail",label:"Browser Detail",minWidth:70}];var j={},K=U;Object.defineProperty(j,"__esModule",{value:!0});var g=j.default=void 0,X=K(T()),Z=e,ee=(0,X.default)((0,Z.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility");g=j.default=ee;const te=M.span`
  display: inline-block;
  color: white;
  font-weight: 500;
  min-width: 125px;
  vertical-align: top;
`,ue=()=>{var b;const z=O("(min-width:1280px)"),[C,y]=o.useState(!1),[s,I]=o.useState({type:"login",pageSize:25,toDate:w().format("YYYY-MM-DD"),fromDate:w().subtract(2,"week").format("YYYY-MM-DD")}),[u,p]=o.useState([]),[A,x]=o.useState([]),{isSignedIn:S}=o.useContext(_),F=k();o.useEffect(()=>(S===!1&&F("/"),()=>{}),[S]);const[d,m]=o.useState(1),[D,h]=L.useState(-1),R=()=>{h(-1)};return o.useEffect(()=>{(async()=>{if(y(!0),s.type==="login"){const{response:t}=await v.loginHistory(s);t!=null&&t.data?(x(t.data),p(t.data.map((a,c)=>{const i={...a};return i.id=c,i.date=new Date(a.lastLogin).toLocaleString(),i.username=a.userid,i.ip=e.jsxs("span",{children:[a.ip," ",e.jsx(g,{fontSize:"small",onClick:()=>h(c)})]}),i})),m(1)):(x([]),p([]))}else if(s.type==="password"){const{response:t}=await v.passwordHistory(s);t!=null&&t.data?(x(t.data),p(t.data.map((a,c)=>{const i={...a};return i.id=c,i.username=a.userId,i.date=new Date(a.createdOn).toLocaleString(),i.ip=e.jsxs("span",{children:[a.ipAddress," ",e.jsx(g,{fontSize:"small",onClick:()=>h(c)})]}),i.detail=e.jsx(J,{title:a.deviceInfo,enterTouchDelay:1,children:e.jsx(r,{sx:{textDecoration:"underline",cursor:"pointer",width:"min-content"},children:"Detail"})}),i})),m(1)):(x([]),p([]))}y(!1)})()},[s]),e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsx(V,{open:D>=0,handleClose:R,title:"IP Detail",children:e.jsxs(l,{container:!0,fontSize:"0.8rem",rowGap:1,children:[e.jsx(l,{sx:{opacity:.6},xs:6,item:!0,children:"IP:"})," ",e.jsx(l,{xs:6,item:!0,children:(b=A[D])==null?void 0:b.ip})," ",e.jsx(l,{sx:{opacity:.6},xs:6,item:!0,children:"City:"})," ",e.jsx(l,{xs:6,item:!0,children:"Delhi"})," ",e.jsx(l,{sx:{opacity:.6},xs:6,item:!0,children:"Country:"})," ",e.jsx(l,{xs:6,item:!0,children:"India"})]})}),!z&&e.jsx($,{}),C&&e.jsx(r,{sx:{opacity:.8,zIndex:20},height:"100%",position:"absolute",width:"100%",children:e.jsx(N,{})}),e.jsxs(r,{minHeight:"calc(100vh - 60px)",children:[e.jsx(Y,{searchFilters:s,setSearchFilters:I}),e.jsx(r,{sx:{display:{xs:"none",lg:"block"}},children:e.jsx(Q,{rows:u.slice((d-1)*s.pageSize,d*s.pageSize),columns:s.type==="login"?f.filter(n=>n.id!=="detail"):f})}),e.jsx(r,{textAlign:"left",sx:{display:{xs:"block",lg:"none"}},fontSize:"0.75rem",children:u.slice((d-1)*s.pageSize,d*s.pageSize).map(n=>e.jsxs(e.Fragment,{children:[e.jsx(r,{py:{xs:.5,md:2,lg:1},px:{xs:1,md:4,lg:1},children:f.filter(t=>s.type==="login"?t.id!=="detail":!0).map(t=>e.jsxs(r,{py:.3,children:[e.jsx(te,{children:t.label}),e.jsxs(r,{display:"inline-block",maxWidth:"calc(100% - 130px)",component:"span",children:[n[t.id]," "]})]}))},`${s.type} - ${n.id}`),e.jsx(G,{})]}))}),e.jsx(B,{count:Math.ceil(u.length/s.pageSize),siblingCount:0,color:"secondary",page:d,onChange:(n,t)=>m(t),renderItem:n=>e.jsx(E,{slots:{first:W,last:q},...n}),sx:{display:"inline-block",maxWidth:"100%",m:"auto",justifyContent:"center"},showFirstButton:!0,showLastButton:!0})]})]}),e.jsx(H,{})]})};export{ue as default};
